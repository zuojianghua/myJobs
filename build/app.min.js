var ComponentLoginCtrl=["$rootScope","$scope","$location","$window","api","myServiceUtil",function(e,t,a,n,i,r){t.login_data={user_code:"",password:"",captcha:""},t.captcha={captcha_show:$util.getcookie("captcha")>3,url:$util.getcookie("captcha")>3?"index.php?app_act=index/login_create_verify_graph&amp;"+Math.random():""},t.key_press=function(e){"undefined"!=typeof e&&13!=e.keyCode||t.do_login()},t.do_login=function(){var a=r.clone(t.login_data);a.password=$.md5(a.password),a.browser=browser,i.request("login",a).then(function(a){return 1==a.status?(t.login_data.save_login?($util.setcookie("user_code",a.data.user_code,7),$util.setcookie("user_name",a.data.user_name,7),$util.setcookie("user_id",a.data.user_id,7),$util.setcookie("role_name",a.data.role_name,7),$util.setcookie("purview",a.data.purview,7),$util.setcookie("is_login","true",7)):($util.setcookie("user_code",a.data.user_code),$util.setcookie("user_name",a.data.user_name),$util.setcookie("user_id",a.data.user_id),$util.setcookie("role_name",a.data.role_name),$util.setcookie("purview",a.data.purview),$util.setcookie("is_login","true")),e.info_user_name=a.data.user_name,e.login=!0,t.login_data.password="",t.captcha.captcha_show=!1,$util.setcookie("captcha",0,2),e.sys_menu_fav=a.data.fave_list||[],$util.setStorage("sys_menu_fav",e.sys_menu_fav),i.request("sys/purview/get_tree_data_by_role_id",{user_id:$util.getcookie("user_id")}).then(function(t){e.sys_menu=t.data,1!=a.data.role_id&&(e.sys_menu=r.get_menu_by_purview(a.data.purview)),$util.setStorage("sys_menu",e.sys_menu)}),r.get_config_table_set(a.data.user_id)):(t.login_data.password="",$util.setcookie("captcha",a.data,2)),1!=a.status&&a.data>2&&(t.captcha.captcha_show=!0,t.captcha.url="index.php?app_act=index/login_create_verify_graph&amp;"+Math.random()),a})},t.captcha_refresh=function(){t.captcha.url="index.php?app_act=index/login_create_verify_graph&amp;"+Math.random()}}],ComponentMenuCtrl=["$rootScope","$scope","$location","$window",function(e,t,a,n){e.sub_menu=[],e.sub_menu_show=[],t.click_menu1=function(t,a){e.sub_menu=t.child,e.menu1_id=t.purview_id,e.menu1_name=t.name,e.slideShow()},t.click_index=function(){e.menu1_id=0,e.slideHide(),t.goto("/dashboard")},t.click_fav=function(){e.sub_menu=[],e.menu1_id="fav",e.menu1_name="收藏夹",e.slideShow()},t.click_menu2=function(t){return void 0==e.sub_menu_show[t]?void(e.sub_menu_show[t]=!1):void(e.sub_menu_show[t]=!e.sub_menu_show[t])},t.click_menu3=function(t){a.path(t.url),e.shrink=!0,e.stretch=!0},e.shrink=!0,e.stretch=!0,e.slideToggle=function(){e.shrink?e.slideShow():e.slideHide()},e.slideHide=function(){e.shrink=!0,e.stretch=!0},e.slideShow=function(){0!=e.menu1_id&&(e.shrink=!1,e.stretch=!1)}}],ComponentNavCtrl=["$rootScope","$scope","$location","$window","ngDialog","myServiceUtil","api",function(e,t,a,n,i,r,o){t.data={form_data:{},license_data:{}},e.info_user_name=$util.getcookie("user_name"),t.logout=function(){e.login=!1,$util.removecookie("user_code"),$util.removecookie("is_login"),$util.removecookie("user_name"),$util.removecookie("role_name"),$util.removecookie("purview")};var c="";t.change_pass=function(){c=i.open({overlay:!0,disableAnimation:!0,showClose:!0,closeByDocument:!1,width:500,template:"html/component/ComponentChangePass.html",scope:t})},t.warrant=function(){o.request("get_icrm_license",{}).then(function(e){1==e.status&&(t.data.license_data=e.data)});i.open({overlay:!0,disableAnimation:!0,showClose:!0,closeByDocument:!1,width:750,template:"html/component/ComponentWarrant.html",scope:t})},t.search_prompt_on=!1,t.search_data={},t.search_result=[],t.search_prompt=function(){""!=t.search_data.keywords&&(t.search_result=r.get_menu_by_keywords(t.search_data.keywords,5),t.search_result.length>0&&(t.search_prompt_on=!0))},t.search_prompt_hide=function(){t.search_prompt_on=!1},t.search_prompt_show=function(){t.search_result.length>0&&(t.search_prompt_on=!0)},t.search_result_click=function(e){t.goto(e.url),t.search_prompt_hide()},t.form_save=function(){if(""==t.data.form_data.pass_old||void 0==t.data.form_data.pass_old)return void t.notice("原密码不能为空！");if(""==t.data.form_data.pass_new||void 0==t.data.form_data.pass_new)return void t.notice("新密码！");if(""==t.data.form_data.pass_new2||void 0==t.data.form_data.pass_new2)return void t.notice("新密码确认！");if(t.data.form_data.pass_new!=t.data.form_data.pass_new2)return void t.notice("2次新密码不一致！");var e={pass_old:"",pass_new:"",pass_new2:"",user_id:""};e.pass_old=$.md5(t.data.form_data.pass_old),e.pass_new=$.md5(t.data.form_data.pass_new),e.pass_new2=$.md5(t.data.form_data.pass_new2),e.user_id=$util.getcookie("user_id"),o.request("sys/user/change_password",e).then(function(e){1==e.status&&(t.notice("修改成功"),i.close(c),t.logout(),t.data.form_data={})})}}],ComponentTabCtrl=["$rootScope","$scope","$location","$window",function(e,t,a,n){e.click_tab=function(e){a.path(e)},e.close_tab=function(t){"/dashboard"!=t&&(delete e.histroy[t],e.histroy_url&&e.histroy.hasOwnProperty(e.histroy_url)?a.path(e.histroy_url):a.path("/dashboard"),a.replace())},e.close_tab_all=function(){t.confirm("确定要关闭全部页签嘛？",function(){for(var t in e.histroy)e.histroy.hasOwnProperty(t)&&"/dashboard"!=t&&delete e.histroy[t];a.path("/dashboard"),a.replace()})},t.tab_scroll=function(e){var t=$("#tab_ul").scrollLeft();$("#tab_ul").stop(),"left"==e?$("#tab_ul").animate({scrollLeft:t+=300},1e3):"right"==e&&$("#tab_ul").animate({scrollLeft:t-=300},1e3)}}],ComponentTitleCtrl=["$rootScope","$scope",function(e,t){}],DemoAddCtrl=["$rootScope","$scope","$location","$window","api","valid",function(e,t,a,n,i,r){var o={title:"示例新增",form_data:{address_array:{}}};t.data=t.construct(o,"demo/add"),t.title_data=[{ico:"glyphicon-th-list",name:"列表",click:function(){a.path("/demo/index")}}],t.form_save=function(){var e=r.check([{key:"customer_name",valid:"check_required",data:t.data.form_data.customer_name,tip:"顾客名称必填"},{key:"customer_tel",valid:"check_required",data:t.data.form_data.customer_tel,tip:"顾客手机号必填"},{key:"org_code",valid:"check_required",data:t.data.form_data.org_code,tip:"渠道必填"},{key:"shop_code",valid:"check_required",data:t.data.form_data.shop_code,tip:"店铺必填"}]);t.valid=e.data,e.status&&i.request("demo/add",{form_data:t.data.form_data}).then(function(e){!1!==e&&a.path("/demo/index")})},t.form_cancel=function(){t.data.form_data={address_array:{}}}}];DemoAddCtrl.$injector=["$rootScope","$scope","$location","$window","api","valid"];var DemoAutoCtrl=["$rootScope","$scope","$location","$window","api","$http","ngDialog",function(e,t,a,n,r,o,c){var l={title:"代码自动生成器",form_data:{ctrl_array:[{}]},valid_option:{check_eq:"验证是否相等",check_email:"验证邮箱",check_tel:"验证手机号",check_number:"验证数字",check_positive:"验证正整数"}};t.data=t.construct(l,"demo/auto"),t.auto_configs=[["VIP卡档案","crm/vip/index","crm/vip/get_list"],["积分调整单","crm/integral_adjust_record/do_index","crm/integral_adjust_record/get_list"],["新增积分调整单","crm/integral_adjust_record/add","crm/integral_adjust_record/add"],["查看积分调整单","crm/integral_adjust_record/edit","crm/integral_adjust_record/get_detail"],["积分变现单","crm/integral_realize_record/do_index","crm/integral_realize_record/get_list"],["新增积分变现单","crm/integral_realize_record/add","crm/integral_realize_record/add"],["查看积分变现单","crm/integral_realize_record/edit","crm/integral_realize_record/get_detail"],["VIP卡制成投放单","crm/make_card_record/index","crm/make_card_record/get_list"],["新增制成投放单","crm/make_card_record/add","crm/make_card_record/add"],["查看制成投放单","crm/make_card_record/edit","crm/make_card_record/get_detail"],["VIP投放","crm/make_card_record/put","crm/make_card_record/put"],["VIP卡作废","crm/make_card_record/cancel","crm/make_card_record/cancel"],["手机号码变更单","crm/change_tel/index","crm/change_tel/get_list"],["查看手机号码变更","crm/change_tel/edit","crm/change_tel/get_detail"],["VIP等级变更单","crm/move_level/index","crm/move_level/get_list"],["新增VIP等级变更","crm/move_level/add","crm/move_level/add"],["查看VIP等级变更","crm/move_level/edit","crm/move_level/get_detail"],["VIP消费转移单","crm/trans_consume/index","crm/trans_consume/get_list"],["新增VIP消费转移","crm/trans_consume/add","crm/trans_consume/add"],["查看VIP消费转移","crm/trans_consume/edit","crm/trans_consume/get_detail"],["VIP开卡策略","tactic/vip_activate_card_rule/index","tactic/vip_activate_card_rule/get_list"],["新增开卡策略","tactic/vip_activate_card_rule/add","tactic/vip_activate_card_rule/add"],["查看开卡策略","tactic/vip_activate_card_rule/edit","tactic/vip_activate_card_rule/get_detail"],["VIP卡停用策略","tactic/vip_disuse_card_rule/index","tactic/vip_disuse_card_rule/get_list"],["新增停用策略","tactic/vip_disuse_card_rule/add","tactic/vip_disuse_card_rule/add"],["查看停用策略","tactic/vip_disuse_card_rule/edit","tactic/vip_disuse_card_rule/get_detail"],["VIP卡升级策略","tactic/vip_upgrade_rule/index","tactic/vip_upgrade_rule/get_list"],["新增升级策略","tactic/vip_upgrade_rule/add","tactic/vip_upgrade_rule/add"],["查看升级策略","tactic/vip_upgrade_rule/edit","tactic/vip_upgrade_rule/get_detail"],["VIP卡降级策略","tactic/vip_degrade_rule/index","tactic/vip_degrade_rule/get_list"],["新增降级策略","tactic/vip_degrade_rule/add","tactic/vip_degrade_rule/add"],["查看降级策略","tactic/vip_degrade_rule/edit","tactic/vip_degrade_rule/get_detail"],["VIP卡合并策略","tactic/crm_bind/index","tactic/crm_bind/get_list"],["VIP积分抵现策略","tactic/integral_withdrawals/index","tactic/integral_withdrawals/get_list"],["新增抵现策略","tactic/integral_withdrawals/add","tactic/integral_withdrawals/add"],["查看抵现策略","tactic/integral_withdrawals/edit","tactic/integral_withdrawals/get_detail"],["生日优惠策略","tactic/birthday_favour/index","tactic/birthday_favour/get_list"],["新增生日优惠","tactic/birthday_favour/add","tactic/birthday_favour/add"],["查看生日优惠","tactic/birthday_favour/edit","tactic/birthday_favour/get_detail"],["积分兑换策略","tactic/integral_redeem/index","tactic/integral_redeem/get_list"],["新增积分兑换策略","tactic/integral_redeem/add","tactic/integral_redeem/add"],["查看积分兑换策略","tactic/integral_redeem/edit","tactic/integral_redeem/get_detail"],["短信模板","sys/e_message_template/index","sys/e_message_template/get_list"],["新增短信模板","sys/e_message_template/add","sys/e_message_template/add"],["查看短信模板","sys/e_message_template/edit","sys/e_message_template/get_detail"],["短信策略","sys/e_message_strategy/index","sys/e_message_strategy/get_list"],["新增短信策略","sys/e_message_strategy/add","sys/e_message_strategy/add"],["查看短信策略","sys/e_message_strategy/edit","sys/e_message_strategy/get_detail"],["短信业务节点","","sys/e_message_template/get_all_e_message_nodes"],["颜色","base/color/index","base/color/get_list"],["新增颜色","base/color/add","base/color/add"],["查看颜色","base/color/edit","base/color/get_detail"],["尺码","base/size/index","base/size/get_list"],["新增尺码","base/size/add","base/size/add"],["查看尺码","base/size/edit","base/size/get_detail"],["品牌","base/brand/index","base/brand/get_list"],["新增品牌","base/brand/add","base/brand/add"],["查看品牌","base/brand/edit","base/brand/get_detail"],["分类","base/category/index","base/category/get_list"],["新增分类","base/category/add","base/category/add"],["查看分类","base/category/edit","base/category/get_detail"],["品类","base/sort/index","base/sort/get_list"],["新增品类","base/sort/add","base/sort/add"],["查看品类","base/sort/view","base/sort/get_detail"],["年度","base/year/index","base/year/get_list"],["新增年度","base/year/add","base/year/add"],["查看年度","base/year/view","base/year/get_detail"],["季节","base/season/index","base/season/get_list"],["新增季节","base/season/add","base/season/add"],["查看季节","base/season/view","base/season/get_detail"],["系列","base/series/index","base/series/get_list"],["新增系列","base/series/add","base/series/add"],["查看系列","base/series/edit","base/series/get_detail"],["单位","base/unit/index","base/unit/get_list"],["新增单位","base/unit/add","base/unit/add"],["查看单位","base/unit/edit","base/unit/get_detail"],["渠道","base/org/index","base/org/get_list"],["新增渠道","base/org/add","base/org/add"],["查看渠道","base/org/view","base/org/get_detail"],["城市","base/city/index","base/city/get_list"],["查看城市","base/city/edit","base/city/get_detail"],["来源","base/source/index","base/source/get_list"],["查看来源","base/source/edit","base/source/get_detail"],["导购","base/guide/index","base/guide/get_list"],["店铺","base/shop/index","base/shop/get_list"],["查看店铺","base/shop/edit","base/shop/get_detail"],["区域","base/area/index","base/area/get_list"],["新增区域","base/area/add","base/area/add"],["查看区域","base/area/edit","base/area/get_detail"],["商品","base/goods/index","base/goods/get_list"],["新增商品","base/goods/add","base/goods/add"],["查看商品","base/goods/edit","base/goods/get_detail"],["充值方式","crm/card_recharge/index","crm/card_recharge/get_list"],["新增充值方式","crm/card_recharge/add","crm/card_recharge/add"],["查看充值方式","crm/card_recharge/edit","crm/card_recharge/get_detail"],["储值卡类别","crm/card_category/index","crm/card_category/get_list"],["新增储值卡类别","crm/card_category/add","crm/card_category/add"],["查看储值卡类别","crm/card_category/edit","crm/card_category/get_detail"],["储值卡资料","crm/prepaid_card/index","crm/prepaid_card/get_list"],["查看储值卡资料","crm/prepaid_card/edit","crm/prepaid_card/get_detail"],["储值卡制成投放单","crm/prepaid_card_make_record/index","crm/prepaid_card_make_record/get_list"],["新增储值卡投放","crm/prepaid_card_make_record/add","crm/prepaid_card_make_record/add"],["查看储值卡投放","crm/prepaid_card_make_record/edit","crm/prepaid_card_make_record/get_detail"],["投放储值卡","crm/prepaid_card_make_record/put","crm/prepaid_card_make_record/put"],["储值卡销售单","crm/prepaid_card_sell_record/index","crm/prepaid_card_sell_record/get_list"],["新增储值卡销售","crm/prepaid_card_sell_record/add","crm/prepaid_card_sell_record/add"],["查看储值卡销售","crm/prepaid_card_sell_record/edit","crm/prepaid_card_sell_record/get_detail"],["储值卡充值单","crm/prepaid_recharge/index","crm/prepaid_recharge/get_list"],["新增储值卡充值","crm/prepaid_recharge/add","crm/prepaid_recharge/add"],["查看储值卡充值","crm/prepaid_recharge/edit","crm/prepaid_recharge/get_detail"],["储值卡退款单","crm/prepaid_refund/index","crm/prepaid_refund/get_list"],["新增储值卡退款","crm/prepaid_refund/add","crm/prepaid_refund/add"],["查看储值卡退款","crm/prepaid_refund/edit","crm/prepaid_refund/get_list"],["储值卡号","crm/prepaid_card_make_record/get_list_detail","crm/prepaid_card_make_record/get_list_detail"],["营销活动","crm/workflow/index","crm/workflow/get_list"],["新增营销活动","crm/workflow/add","crm/workflow/add"],["查看营销活动","crm/workflow/edit","crm/workflow/get_detail"],["活动屏蔽目标组","crm/workflow_remove/index","crm/workflow_remove/get_list"],["新增目标组","crm/workflow_remove/add","crm/workflow_remove/add"],["查看目标组","crm/workflow_remove/edit","crm/workflow_remove/get_detail"],["营销活动类型","crm/workflow_marketing/index","crm/workflow_marketing/get_list"],["新增活动类型","crm/workflow_marketing/add","crm/workflow_marketing/add"],["查看活动类型","crm/workflow_marketing/edit","crm/workflow_marketing/get_detail"],["营销模板","crm/workflow_template/index","crm/workflow_template/get_list"],["新增营销模板","crm/workflow_template/add","crm/workflow_template/add"],["查看营销模板","crm/workflow_template/get_detail","crm/workflow_template/get_detail"],["促销活动","crm/ipos_promotion/get_list","crm/ipos_promotion/get_list"],["优惠券制成单","crm/coupon_made/index","crm/coupon_made/get_list"],["新增优惠券制成","crm/coupon_made/add","crm/coupon_made/add"],["查看优惠券制成","crm/coupon_made/edit","crm/coupon_made/get_detail"],["批量发放优惠券","crm/coupon_made/send_all","crm/coupon_made/send_all"],["优惠券一览","crm/coupon_made/detail_coupon",""],["客服来电记录","crm/tel_information/index","crm/tel_information/get_list"],["新增来电记录","crm/tel_information/add","crm/tel_information/add"],["查看来电记录","crm/tel_information/view","crm/tel_information/get_detail"],["客服回访记录","crm/return_visit_record/index","crm/return_visit_record/get_list"],["新增回访记录","crm/return_visit_record/add","crm/return_visit_record/add"],["查看回访记录","crm/return_visit_record/edit","crm/return_visit_record/get_detail"],["粉丝档案","wechat/vip/index","wechat/vip/get_list"],["微信素材库","wechat/weixin_img/index","wechat/weixin_img/get_list"],["新建单图文素材","wechat/weixin_img/add_single_img","wechat/weixin_img/add_single_img"],["新建多图文素材","wechat/weixin_img/add_multigraph","wechat/weixin_img/add_multigraph"],["微信高级群发","wechat/weixin_senior_group_news/index","wechat/weixin_senior_group_news/get_list"],["新增微信群发","wechat/weixin_senior_group_news/add","wechat/weixin_senior_group_news/add"],["查看微信群发","wechat/weixin_senior_group_news/edit","wechat/weixin_senior_group_news/get_detail"],["微信问卷调查","wechat/survey/index","wechat/survey/get_list"],["微信抽奖活动","wechat/weixin_lottery/index","wechat/weixin_lottery/get_list"],["新增抽奖活动","wechat/weixin_lottery/add","wechat/weixin_lottery/add"],["查看抽奖活动","wechat/weixin_lottery/view","wechat/weixin_lottery/get_detail"],["优惠券分享","wechat/share_coupon/index","wechat/share_coupon/get_list"],["新增优惠券分享","wechat/share_coupon/add","wechat/share_coupon/add"],["查看优惠券分享","wechat/share_coupon/edit","wechat/share_coupon/get_detail"],["优惠券","crm/coupon/get_list","crm/coupon/get_list"],["图文素材","wechat/weixin_img/get_list","wechat/weixin_img/get_list"],["礼品分类","wechat/gift/category/index","wechat/gift/category/get_list"],["新增礼品分类","wechat/gift/category/add","wechat/gift/category/add"],["编辑礼品分类","wechat/gift/category/edit","wechat/gift/category/get_detail"],["礼品列表","wechat/gift/gift/index","wechat/gift/gift/get_list"],["新增礼品列表","wechat/gift/gift/add","wechat/gift/gift/add"],["查看礼品列表","wechat/gift/gift/edit","wechat/gift/gift/get_detail"],["积分区间","wechat/gift/integral/index","wechat/gift/integral/get_list"],["新增积分区间","wechat/gift/integral/add","wechat/gift/integral/add"],["查看积分区间","wechat/gift/integral/edit","wechat/gift/integral/get_detail"],["礼品订单","wechat/gift_record/index","wechat/gift_record/get_list"],["查看礼品订单","wechat/gift_record/edit","wechat/gift_record/get_detail"],["未审核订单","wechat/gift_record_new/index","wechat/gift_record_new/get_list"],["已审核订单","wechat/gift_record_audit/index","wechat/gift_record_audit/get_list"],["已发货订单","wechat/gift_record_ship/index","wechat/gift_record_ship/get_list"],["已完成订单","wechat/gift_record_complete/index","wechat/gift_record_complete/get_list"],["已取消订单","wechat/gift_record_cancel/index","wechat/gift_record_cancel/get_list"],["未审核退单","wechat/gift_record_return/index","wechat/gift_record_return/get_list"],["查看退单","wechat/gift_record_return/edit","wechat/gift_record_return/get_detail"],["已审核退单","wechat/gift_record_return_audit/index","wechat/gift_record_return_audit/get_list"],["已完成退单","wechat/gift_record_return_complete/index","wechat/gift_record_return_complete/get_list"],["商品评价回复","base/evaluate_goods/index","base/evaluate_goods/get_list"]];var d=function(e){return"undefined"==typeof e?"":e.replace(/(\w)/,function(e){return e.toUpperCase()})},u=function(e){if("undefined"==typeof e)return"";var t=e.split("_"),a="";return t.forEach(function(e){a+=d(e)}),a};t.generate_path=function(){t.data.form_data.ctrl_array.forEach(function(e){var t=e.ctrl_name.split("/");e.ctrl_class=u(t[0])+u(t[1])+u(t[2])+"Ctrl",e.ctrl_path="controller/"+t[0]+"/"+t[1]+"/"+u(t[0])+u(t[1])+u(t[2])+"Ctrl.js",e.html_path="html/"+t[0]+"/"+t[1]+"/"+u(t[0])+u(t[1])+u(t[2])+".html",e.html_script='<script src="'+e.ctrl_path+'"></script>\n',e.app_script=".when('/"+e.ctrl_name+"', { templateUrl: '"+e.html_path+"', controller:  "+e.ctrl_class+"})\n",e.ctrl_name.indexOf("index")!=-1&&(e.ctrl_type="list"),e.ctrl_name.indexOf("edit")==-1&&e.ctrl_name.indexOf("view")==-1||(e.ctrl_type="view"),e.ctrl_name.indexOf("add")!=-1&&(e.ctrl_type="add")}),t.data.form_data.html_script="",t.data.form_data.app_script="",t.data.form_data.ctrl_array.forEach(function(e){t.data.form_data.html_script+=e.html_script,t.data.form_data.app_script+=e.app_script})},t.get_api=function(e){e.table_fields=[],r.request(e.ctrl_api).then(function(t){e.api_data=t.data;for(i in t.data.data[0])e.table_fields.push({keyword:i,label:"",orders:""})})},t.form_save=function(){t.dialog_title="自动生成相应代码...",open_save_window_id=c.open({overlay:!0,disableAnimation:!0,showClose:!0,width:"",template:"html/demo/DemoAutoDialogSave.html",scope:t}),o.post("angular.php",t.data.form_data).then(function(e){console.log(e.data),t.result=e.data})},t.get_api_data=function(){t.dialog_title="获取API演示数据...",t.result={"执行中请稍等...":!0},open_select_window_id=c.open({overlay:!0,disableAnimation:!0,showClose:!0,width:"",template:"html/demo/DemoAutoDialogApi.html",scope:t}),o.post("get_api_data.php",{data:t.auto_configs}).then(function(e){t.result=e.data})};var s;t.show_all_pages=function(){t.dialog_title="查看全部页面",t.result=t.auto_configs,s=c.open({overlay:!0,disableAnimation:!0,showClose:!0,width:"",template:"src/html/demo/DemoAutoDialogPage.html",scope:t}),o.post("check_file_status.php",{data:t.auto_configs}).then(function(e){t.result=e.data})},t.click_ctrl=function(e){c.close(s),t.data.form_data.ctrl_array[0].ctrl_name=e.ctrl,t.data.form_data.ctrl_array[0].ctrl_title=e.title,t.data.form_data.ctrl_array[0].ctrl_api=e.api,t.generate_path(),t.get_api(t.data.form_data.ctrl_array[0])},t.title_data=[{ico:"glyphicon-refresh",name:"获取API演示数据",click:function(){t.get_api_data()}},{ico:"glyphicon-th-list",name:"查看全部页面",click:function(){t.show_all_pages()}}]}];DemoAutoCtrl.$injector=["$rootScope","$scope","$location","$window","api","$http","ngDialog"];var DemoListCtrl=["$rootScope","$scope","$location","$window","api",function(e,t,a,n,i){var r={title:"标题",list_data:[],page_data:{},search_data:{}};t.data=t.construct(r,"demo/list"),t.form_clear=function(){t.data.search_data={}},t.form_search=function(){i.request("demo/get_list",{search_data:t.data.search_data,page_data:t.data.page_data}).then(function(e){1==e.status&&(t.data.list_data=e.data.data,t.data.page_data=e.data.page_data),console.log(t.data.list_data)})},void 0!=t.data.list_data&&0!=t.data.list_data.length||t.form_search(),t.title_data=[{ico:"glyphicon-plus",name:"新增",click:function(){a.path("/crm/vip_level/add")}}]}];DemoListCtrl.$injector=["$rootScope","$scope","$location","$window","api"];var DemoMarkdownCtrl=["$rootScope","$scope","$location","$window","api","valid","$routeParams",function(e,t,a,n,i,r,o){var c={title:"入口",form_data:{},markdown:""};t.data=t.construct(c,"demo/markdown/"+o.name),t.title_data=[],t.data.markdown="html/doc/markdown/"+o.name}];DemoMarkdownCtrl.$injector=["$rootScope","$scope","$location","$window","api","valid","$routeParams"];var DemoViewCtrl=["$rootScope","$scope","$location","$window",function(e,t,a,n){if(e.nav="n0",e.menu="m1",e.subMenu="s02",e.url="/demo/view",e.histroy.hasOwnProperty("/demo/view")){var i=e.histroy["/demo/view"].order;t.order=i}else{var i=Object.keys(e.histroy);t={title:"测试列表页",content:"",order:i},e.histroy["/demo/view"]={scope:t,order:i}}}];DemoViewCtrl.$injector=["$rootScope","$scope","$location","$window"];var DocMarkdownCtrl=["$rootScope","$scope","$location","$window","api","valid","$routeParams",function(e,t,a,n,i,r,o){var c={title:"",form_data:{},markdown:""};t.data=t.construct(c,"/doc/"+o.group+"/"+o.md),t.data.title=e.now_menu,t.title_data=[{ico:"glyphicon-backward",name:"上一篇",click:function(){a.path("")}},{ico:"glyphicon-forward",name:"下一篇",click:function(){a.path("")}},{ico:"glyphicon-refresh",name:"刷新",click:function(){}}],t.data.mdfile="html/doc/"+o.group+"/"+o.md}];DocMarkdownCtrl.$injector=["$rootScope","$scope","$location","$window","api","valid","$routeParams"];var IndexDashboardCtrl=["$rootScope","$scope","$location","$window",function(e,t,a,n){var i={content:"测试数据",title:"首页"};t.data=t.construct(i,"dashboard"),console.log("111")}];IndexDashboardCtrl.$injector=["$rootScope","$scope","$location","$window"];var IndexMainCtrl=["$rootScope","$scope","$location","$window","$timeout","$q","ngDialog","Popup","api","myServiceUtil","myConfigSys","myServiceDatabind","myConfigUI","myServiceOptions",function(e,t,a,n,i,r,o,c,l,d,u,s,_,p){e.config_table_set={},e.config_sys=u,$util.getcookie("user_code")&&"true"==$util.getcookie("is_login")?(e.login=!0,e.sys_menu=$util.getStorage("sys_menu"),e.sys_menu_fav=$util.getStorage("sys_menu_fav")):(e.login=!1,e.sys_menu=[],e.sys_menu_fav=[]),e.histroy={},e.$on("$routeChangeStart",function(a,n,i){return"undefined"!=typeof i&&"undefined"!=typeof i.$$route&&(e.histroy_url=i.$$route.originalPath),"undefined"!=typeof e.histroy&&Object.keys(e.histroy).length>30?(t.alert("你打开了太多的TAB"),void a.preventDefault()):("undefined"!=typeof n&&"undefined"!=typeof n.$$route&&(t.debug_router=n.$$route.originalPath),void(t.debug_wacth=[{name:"",value:void 0}]))}),t.debug_window=0,t.add_watch=function(){t.debug_wacth.push({name:"",value:""})},t.change_watch=function(a){a.value=e[a.name]?e[a.name]:e.histroy[t.debug_router].scope.data[a.name]},t.del_watch=function(e){console.log(e),t.debug_wacth.length>1?t.debug_wacth.splice(e,1):t.debug_wacth=[{name:"",value:void 0}]},e.search_data_option=e.form_data_option=p.option,e.search_data_select=p.selector,t.select_department=s.select_department,t.select_user=s.select_user,t.config={},t.config.color_picker_options=_.color_picker_options,t.config.ta_toolbar_options=_.ta_toolbar_options;var m=$util.getStorage("pager_conf_local")?$util.getStorage("pager_conf_local"):{};t.construct=function(a,n){var i=d.get_menu_by_url(n);e.menu1_id=i.m1.purview_id||0,e.menu2_id=i.m2.purview_id,e.menu3_id=i.m3.purview_id,e.bread_menu=i.m2.name+" / "+i.m3.name,e.now_menu=i.m3.name,e.menu1_name=i.m1.name,e.sub_menu=i.m1.child;var r=e.url=n;if(e.collection=d.get_fav_status(r),e.histroy.hasOwnProperty(r))return t.speak(e.histroy[r].scope.data.title),e.histroy[r].scope.data;a.table_setting&&(e.config_table_set[n]&&"false"!=e.config_table_set[n]||(e.config_table_set[n]={}),a.config_table_set_route=e.config_table_set[n]),a.page_data&&(a.page_data.num=m[r]?parseInt(m[r]):15);var o=Object.keys(e.histroy);return e.histroy[r]={scope:{data:a},order:o},t.speak(a.title),a},t.goto=function(e){a.path(e)},t.add_to_fave=function(){var a=$util.getcookie("user_id"),n=e.url,i={};if(e.collection)i={url:n,user_id:a},l.request("del_fave",i).then(function(a){a.status&&(e.collection=!e.collection,d.remove_from_fav(i),t.notice(a.message))});else{var r=e.histroy[n].scope.data.title;i={name:r,url:n,user_id:a},l.request("fave",i).then(function(a){a.status&&(e.collection=!e.collection,d.add_to_fav(i),t.notice(a.message))})}},t.refresh=function(){},t.toggle_search_field_more=function(e){e=!e},"undefined"==typeof e.config_sys.can_speak&&(e.config_sys.can_speak=!1),t.speak=function(t){e.config_sys.can_speak&&"undefined"!=typeof t&&""!=t&&i(function(){var e=$("<audio autoplay='autoplay'>语音播报</audio>").attr("src","http://tts.baidu.com/text2audio?lan=zh&pid=101&ie=UTF-8&text="+t+"&spd=6");$("body").append(e),e[0].onended=function(){e.remove()}},0)},t.notice=function(e,a){t.speak(e),c.notice(e,a)},t.alert=function(e,a){t.speak(e),c.alert(e,a)},t.confirm=function(e,a,n){t.speak(e),c.confirm(e,a,n)},t.bubble={},t.set_table_list_field=function(e,a){var n=o.open({overlay:!0,disableAnimation:!0,showClose:!0,width:"400px",template:"src/html/component/ComponentDialogTableSet.html",scope:t,controller:["$rootScope","$scope",function(t,i){i.fields_set=[],t.config_table_set[e]||(t.config_table_set[e]={}),a.forEach(function(a){i.fields_set.push({key:a.key,value:t.config_table_set[e][a.key]!==!1&&"false"!==t.config_table_set[e][a.key],name:a.name})}),i.save_fields_set=function(){i.fields_set.forEach(function(a){0==a.value?t.config_table_set[e][a.key]=!1:t.config_table_set[e][a.key]=!0});var a=$util.getcookie("user_id");$util.setStorage("config_table_set_"+a,t.config_table_set),l.request("sys/user_html_config/add",{user_id:a,url:e,context:t.config_table_set[e]}).then(function(e){1==e.status&&i.notice("保存成功")}),o.close(n)}}]})}}];IndexMainCtrl.$injector=["$rootScope","$scope","$location","$window","$timeout","$q","ngDialog","Popup","api","myServiceUtil","myConfigSys","myServiceDatabind","myConfigUI","myServiceOptions"];var JobsIndexCtrl=["$rootScope","$scope","$location","$window","api",function(e,t,a,n,i){var r={title:"标题",list_data:[],page_data:{},search_data:{}};t.data=t.construct(r,"demo/list"),t.form_clear=function(){t.data.search_data={}},t.form_search=function(){i.request("demo/get_list",{search_data:t.data.search_data,page_data:t.data.page_data}).then(function(e){1==e.status&&(t.data.list_data=e.data.data,t.data.page_data=e.data.page_data),console.log(t.data.list_data)})},void 0!=t.data.list_data&&0!=t.data.list_data.length||t.form_search(),t.title_data=[{ico:"glyphicon-plus",name:"新增",click:function(){a.path("/crm/vip_level/add")}}]}];JobsIndexCtrl.$injector=["$rootScope","$scope","$location","$window","api"];var DocRouteEntryCtrl=["$rootScope","$scope","$location","$window","api","valid",function(e,t,a,n,i,r){var o={title:"入口",form_data:{address_array:{}}};t.data=t.construct(o,"doc/route/entry"),t.title_data=[{ico:"glyphicon-th-list",name:"列表",click:function(){a.path("/doc/route/entry")}}],t.form_save=function(){var e=r.check([]);t.valid=e.data,e.status&&i.request("",{form_data:t.data.form_data}).then(function(e){!1!==e&&a.path("/doc/route/entry")})},t.form_cancel=function(){t.data.form_data={address_array:{}}}}];DocRouteEntryCtrl.$injector=["$rootScope","$scope","$location","$window","api","valid"];var myApp=angular.module("myApp",["ngRoute","ngDialog","ngAnimate","ngTouch","myService","myConfig","myDirective","myFilters","ui.calendar","color.picker","textAngular","ngFileUpload","angular-echarts","angular-popups"]).controller("IndexMainCtrl",IndexMainCtrl).controller("ComponentNavCtrl",ComponentNavCtrl).controller("ComponentMenuCtrl",ComponentMenuCtrl).controller("ComponentTabCtrl",ComponentTabCtrl).controller("ComponentLoginCtrl",ComponentLoginCtrl).controller("ComponentTitleCtrl",ComponentTitleCtrl).config(["$routeProvider","$httpProvider",function(e,t){e.when("/dashboard",{templateUrl:"html/index/IndexDashboard.html",controller:IndexDashboardCtrl}).when("/jobs/index",{templateUrl:"html/jobs/JobsList.html",controller:JobsIndexCtrl}).otherwise({redirectTo:"/dashboard"}),t.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded;charset=utf-8";var a=function(e){var t,n,i,r,o,c,l,d="";for(t in e)if(n=e[t],n instanceof Array)for(l=0;l<n.length;++l)o=n[l],i=t+"["+l+"]",c={},c[i]=o,d+=a(c)+"&";else if(n instanceof Object)for(r in n)o=n[r],i=t+"["+r+"]",c={},c[i]=o,d+=a(c)+"&";else void 0!==n&&null!==n&&(d+=encodeURIComponent(t)+"="+encodeURIComponent(n)+"&");return d.length?d.substr(0,d.length-1):d};t.defaults.transformRequest=[function(e){return angular.isObject(e)&&"[object File]"!==String(e)?a(e):e}]}]);angular.module("myConfig",[]).factory("myConfigSys",function(){return{can_speak:!1,fake_api:!0,api_path:"",api_log:"none",dump_mode:!0,app_path:"src",has_fav:!1}}).factory("myConfigUI",function(){return{color_picker_options:{format:"hex",alpha:!1,close:{show:!1,label:"关闭",class:""},clear:{show:!1,label:"清除",class:""},reset:{show:!1,label:"重置",class:""}},ta_toolbar_options:[["h1","h2","h3","p","bold","italics","strikeThrough","ul","ol"],["indent","outdent","justifyLeft","justifyCenter","justifyRight","justifyFull"],["insertImage","insertLink","insertVideo"],["undo","redo","clear","html","charcount"]]}});var myDirective=angular.module("myDirective",[]);angular.module("myFilters",[]).filter("orderObjectBy",function(){return function(e,t,a){var n=[];return angular.forEach(e,function(e){n.push(e)}),n.sort(function(e,a){return e[t]>a[t]?1:-1}),a&&n.reverse(),n}}).filter("checkmark",function(){return function(e){return e===!0||"true"===e||1===e||"1"===e?"✓":"✘"}}).filter("resolvetypemark",function(){return function(e){return"0"==e||0==e?"未处理":"-1"==e||e==-1?"问题单":"1"==e||1==e?"处理成功":""}}).filter("cancelmark",function(){return function(e){return e===!0||"true"===e||1===e||"1"===e?"✓":""}}).filter("transtypemark",function(){return function(e){return e===!0||"true"===e||1===e||"1"===e?"按消费单转移":"全卡消费数据转移"}}).filter("sysmark",function(){return function(e){return e===!0||"true"===e||1===e||"1"===e?"是":"否"}}).filter("finalmark",function(){return function(e){return e===!0||"true"===e||1===e||"1"===e?"是":"否"}}).filter("distributortypemark",function(){return function(e){return e===!0||"true"===e||1===e||"1"===e?"实体店":"网络店"}}).filter("handlemark",function(){return function(e){return e===!0||"true"===e||1===e||"1"===e?"已处理":"未处理"}}).filter("imgtypemark",function(){
return function(e){return e===!0||"true"===e||1===e||"1"===e?"多图文":"单图文"}}).filter("logintypemark",function(){return function(e){return e===!0||"true"===e||1===e||"1"===e?"退出":"登录"}}).filter("vipmark",function(){return function(e){return e===!1||"false"===e?"":e}}).filter("giftdistributortypemark",function(){return function(e){return e===!0||"true"===e||1===e||"1"===e?"部分":"全部"}}).filter("deliverytypemark",function(){return function(e){return e===!0||"true"===e||1===e||"1"===e?"快递":"自取"}}).filter("apistatusmark",function(){return function(e){return e===!0||"true"===e||1===e||"1"===e?"成功":"失败"}}).filter("consumetypemark",function(){return function(e){return 0===e||"0"===e?"消费":"退货"}}).filter("applicationscopemark",function(){return function(e){return 1===e||"1"===e?"全部":"部分"}}).filter("birthscopemark",function(){return function(e){return 1===e||"1"===e?"全部":"仅限生日会员"}}).filter("noticetypemark",function(){return function(e){return 1===e||"1"===e?"其他":"活动公告"}}).filter("inputtypemark",function(){return function(e){return 1===e||"1"===e?"文本框":"下拉框"}}).filter("noticestatusmark",function(){return function(e){return"0"==e||0==e?"未确认":"1"==e||1==e?"已确认":"2"==e||2==e?"已审批":"3"==e||3==e?"已作废":""}}).filter("favourmark",function(){return function(e){return"0"==e||0==e?"当月":"1"==e||1==e?"当天":"2"==e||2==e?"当年":"3"==e||3==e?"前后n天":""}}).filter("favourtypemark",function(){return function(e){return"0"==e||0==e?"指定金额":"1"==e||1==e?"指定折扣":"2"==e||2==e?"优惠金额":""}}).filter("sexmark",function(){return function(e){return 1==e||"1"==e?"男":2==e||"2"==e?"女":3==e||"3"==e?"保密":""}}).filter("citytypemark",function(){return function(e){return 0==e||"0"==e?"无等级":1==e||"1"==e?"一线城市":2==e||"2"==e?"二线城市":""}}).filter("sourcetypemark",function(){return function(e){return 0==e||"0"==e?"无类型":1==e||"1"==e?"线上":2==e||"2"==e?"线下":""}}).filter("cardstatusmark",function(){return function(e){return 0==e||"0"==e?"正常":1==e||"1"==e?"停用":2==e||"2"==e?"挂失":3==e||"3"==e?"已使用":4==e||"4"==e?"过期":5==e||"5"==e?"作废":""}}).filter("workflowstatusmark",function(){return function(e){return 0==e||"0"==e?"初始":1==e||"1"==e?"设计流程":2==e||"2"==e?"审批通过":3==e||"3"==e?"开始执行":4==e||"4"==e?"执行中":5==e||"5"==e?"执行完成":6==e||"6"==e?"生成报表":7==e||"7"==e?"完成":8==e||"8"==e?"终止":""}}).filter("recordstatusmark",function(){return function(e){return 0==e||"0"==e?"审核中":1==e||"1"==e?"已审核拣货中":3==e||"3"==e?"已发货":5==e||"5"==e?"已完成":7==e||"7"==e?"已取消":8==e||"8"==e?"申请退货":9==e||"9"==e?"确认退货":11==e||"11"==e?"完成退货":""}}).filter("issendmark",function(){return function(e){return 0==e||"0"==e?"未发送":1==e||"1"==e?"已发送":2==e||"2"==e?"发送中":""}}).filter("activitytypemark",function(){return function(e){return 1==e||"1"==e?"大转盘":2==e||"2"==e?"刮刮卡":3==e||"3"==e?"竞猜":4==e||"4"==e?"投票":""}}).filter("activitystatusmark",function(){return function(e){return 0==e||"0"==e?"待审核":1==e||"1"==e?"待发布":2==e||"2"==e?"进行中":3==e||"3"==e?"已结束":4==e||"4"==e?"已终止":""}}).filter("workflowtypemark",function(){return function(e){return 0==e||"0"==e?"手机":""}}).filter("sourcemark",function(){return function(e){return 1==e||"1"==e?"erp":6==e||"6"==e?"pos":7==e||"7"==e?"百胜icrm":8==e||"8"==e?"e3后台":9==e||"9"==e?"淘宝":10==e||"10"==e?"拍拍":11==e||"11"==e?"openshop":12==e||"12"==e?"分销商":13==e||"13"==e?"京东":14==e||"14"==e?"亚马逊":15==e||"15"==e?"QQ网购":16==e||"16"==e?"一号店":17==e||"17"==e?"eBay":18==e||"18"==e?"网络分销主站":19==e||"19"==e?"淘宝分销":20==e||"20"==e?"新浪":21==e||"21"==e?"shopex":22==e||"22"==e?"ecshop":23==e||"23"==e?"当当":24==e||"24"==e?"邮乐":25==e||"25"==e?"乐酷天":26==e||"26"==e?"shopex分销王":27==e||"27"==e?"vjia":28==e||"28"==e?"优购":29==e||"29"==e?"efast":30==e||"30"==e?"微购物":31==e||"31"==e?"微信":32==e||"32"==e?"苏宁":33==e||"33"==e?"唯品会":34==e||"34"==e?"聚美优品":35==e||"35"==e?"卖网":36==e||"36"==e?"库巴":37==e||"37"==e?"名鞋库":38==e||"38"==e?"阿里巴巴":39==e||"39"==e?"口袋通":40==e||"40"==e?"工行":41==e||"41"==e?"银泰":42==e||"42"==e?"走秀网":43==e||"43"==e?"贝贝网":44==e||"44"==e?"蘑菇街":45==e||"45"==e?"拍鞋网":46==e||"46"==e?"好乐买":47==e||"47"==e?"乐蜂":48==e||"48"==e?"微盟":49==e||"49"==e?"折800":50==e||"50"==e?"OS主站":51==e||"51"==e?"API接口":52==e||"52"==e?"ncm":53==e||"53"==e?"BSERP2":54==e||"54"==e?"BS3000+":55==e||"55"==e?"第三方仓储物流":56==e||"56"==e?"唯品会JIT":57==e||"57"==e?"ISHOP":58==e||"58"==e?"飞牛":59==e||"59"==e?"蜜芽":60==e||"60"==e?"百度mall接口":61==e||"61"==e?"三足接口":62==e||"62"==e?"移动pos":63==e||"63"==e?"M6":65==e||"65"==e?"速卖通":66==e||"66"==e?"明星衣橱":67==e||"67"==e?"百胜E3":68==e||"68"==e?"润和pos":9e3==e||"9000"==e?"错误来源":""}}).filter("percentageMark",function(){return function(e){return(100*parseFloat(e)).toFixed(2)+"%"}}).filter("crontabtypemark",function(){return function(e){return 0==e||"0"==e?"指定频率":1==e||"1"==e?"每月第一天":"未知类型"}}).filter("emessagetypemark",function(){return function(e){return 0==e||"0"==e?"其它":1==e||"1"==e?"营销":2==e||"2"==e?"订单":3==e||"3"==e?"激活":4==e||"4"==e?"注册":""}}).filter("formatmoneymark",function(){return function(e){return Number(e).toFixed(2)}}).filter("subscribemark",function(){return function(e){return 0==e||"0"==e?"否":1==e||"1"==e?"是":""}}).filter("default",function(){return function(e,t){return void 0==e||""==e?t:e}}),angular.module("myService",[]).factory("api",["$rootScope","$http","$location","$q","Popup","myConfigSys",function(e,t,a,n,i,r){var o=function(e,a){var n="../api_demo/"+e+".json";return t.get(n,a).then(function(e){return 1==e.data.status?e.data:(i.notice(e.data.message),!1)}).catch(function(e){return i.notice("网络访问失败"),!1})},c=function(e,a,n){var r="index.php?app_act="+e;return a&&(a.user_info={user_id:$util.getcookie("user_id"),user_code:$util.getcookie("user_code")}),t.post(r,a,n).then(function(e){return 1==e.data.status?e.data:(i.notice(e.data.message),e.data)}).catch(function(e){return i.notice("网络访问失败"),!1})},l=function(t,a,n){return e.config_sys.fake_api===!0?o(t,a,n):c(t,a,n)},d=function(e){var t="index.php?app_act="+e;return t};return e.config_sys||(e.config_sys=r),{get_api_url:d,request:l,request_demo:o}}]).factory("myServiceUtil",["$rootScope","api",function(e,t){var a=function(t){var a={m1:"",m2:"",m3:""};return e.sys_menu.forEach(function(e){e.child.forEach(function(n){n.child.forEach(function(i){if(t==i.url)return a.m1=e,a.m2=n,void(a.m3=i)}),""!=a.m3}),""!=a.m3}),a},n=function(t,a){var n=new RegExp(t,"ig"),i=[];return e.sys_menu.forEach(function(e){e.child.forEach(function(e){e.child.forEach(function(e){n.test(e.name)&&i.push(e)})})}),a&&a>0&&i.splice(a),i},i=function(t){var a=t.split(",");return e.sys_menu.forEach(function(t,n){-1==a.indexOf(t.purview_id)?e.sys_menu.splice(n,1):t.child.forEach(function(e,n){-1==a.indexOf(e.purview_id)?t.child.splice(n,1):e.child.forEach(function(t,n){-1==a.indexOf(t.purview_id)&&e.child.splice(n,1)})})}),e.sys_menu},r=function(e){return"undefined"==typeof e?"":e.replace(/(\w)/,function(e){return e.toUpperCase()})},o=function(e){if("undefined"==typeof e)return"";var t=e.split("_"),a="";return t.forEach(function(e){a+=r(e)}),a},c=function(t){var a=e.sys_menu_fav,n=!1;return a.forEach(function(e){e.url==t&&(n=!0)}),n},l=function(t){e.sys_menu_fav.push(t),$util.setStorage("sys_menu_fav",e.sys_menu_fav)},d=function(t){var a=!1;e.sys_menu_fav.forEach(function(e,n){e.url==t.url&&(a=n)}),a!==!1&&e.sys_menu_fav.splice(a,1),$util.setStorage("sys_menu_fav",e.sys_menu_fav)},u=function(a){return t.request("sys/user_html_config/get_by_user_id",{user_id:a}).then(function(t){if(1==t.status){var n={};t.data.forEach(function(e){n[e.url]=e.context}),$util.setStorage("config_table_set_"+a,n),e.config_table_set=n}else e.config_table_set=$util.getStorage("config_table_set_"+a)?$util.getStorage("config_table_set_"+a):{}})},s=function(e){return JSON.parse(JSON.stringify(e))};return{get_menu_by_url:a,get_menu_by_keywords:n,get_menu_by_purview:i,get_fav_status:c,add_to_fav:l,remove_from_fav:d,get_config_table_set:u,strtoUp:r,strtoUp2:o,clone:s}}]).factory("valid",["$rootScope",function(e){var t=function(e){return"undefined"!=typeof e&&void 0!=e&&""!=e&&null!=e},a=function(e){return!!(/^(\+|-)?\d+$/.test(e)&&e>0)},n=function(e){return!!(/^(\+|-)?\d+$/.test(e)&&e>=0)},i=function(e){return!!/^(1(([35][0-9])|(47)|[8][0-9]))\d{8}$/.test(e)},r=function(e){return e>=0&&e<=1},o=function(e){return e>=1&&e<=100},c=function(e){return!!(/^[0-9]+.?[0-9]*$/.test(e)&&e>=0)},l=function(e){return!!(/^[0-9]+.?[0-9]*$/.test(e)&&e>0)},d=function(e){return e[0]===e[1]},u=function(e){return!!/^\d+(\.\d{2})*$/.test(e)},s=function(e,s){switch(e){case"check_required":return t(s);case"check_positive_integer":return a(s);case"check_integer":return n(s);case"check_mobile":return i(s);case"check_zero_one":return r(s);case"check_one_hundred":return o(s);case"check_zero_positive":return c(s);case"check_positive":return l(s);case"check_money_format":return u(s);case"check_eq":return d(s)}return!0},_=function(e){var t={status:!0,data:{}};return e.forEach(function(e){s(e.valid,e.data)?(t.data[e.key]="success",t.data[e.key+"_ico"]="glyphicon-ok",t.data[e.key+"_tip"]=""):(t.status=!1,t.data[e.key]="error",t.data[e.key+"_ico"]="glyphicon-warning-sign",t.data[e.key+"_tip"]=e.tip)}),t};return{check:_,check_required:t,check_positive_integer:a,check_integer:n,check_mobile:i,check_zero_one:r,check_one_hundred:o,check_zero_positive:c,check_positive:l,check_money_format:u,check_eq:d}}]).factory("myServiceDatabind",["$rootScope","api",function(e,t){var a=function(e){return t.request("sys/department/get_list",e).then(function(e){var t=$q.defer(),a={filter_data:e.data.search_data,data:[],page_data:e.data.page_data};return e.data.data.forEach(function(e){a.data.push({code:e.department_code,name:e.department_name})}),t.resolve(a),t.promise})},n=function(e){return t.request("sys/user/get_list",e).then(function(e){var t=$q.defer(),a={filter_data:e.data.search_data,data:[],page_data:e.data.page_data};return e.data.data.forEach(function(e){a.data.push({code:e.user_code,name:e.user_name})}),t.resolve(a),t.promise})};return{select_department:a,select_user:n}}]).factory("myServiceOptions",["$rootScope","api",function(e,t){return{option:{customer_sex_options:{0:"保密",1:"男",2:"女"},weixin_type_options:{0:"认证服务号"},_options:{}},selector:{select_department:"选择部门",select_user:"选择用户/店员"}}}]),function(e){function t(e,t,a,n){return"function"==typeof t&&(n=a,a=t,t=void 0),"function"!=typeof a&&(n=a,a=void 0),{url:e,data:t,fnSuc:a,dataType:n}}var a={},n=/android/gi.test(navigator.appVersion),i=function(){var t=e.localStorage;return n&&(t=os.localStorage()),t};a.trim=function(e){return String.prototype.trim?null==e?"":String.prototype.trim.call(e):e.replace(/(^\s*)|(\s*$)/g,"")},a.trimAll=function(e){return e.replace(/\s*/g,"")},a.isElement=function(e){return!(!e||1!=e.nodeType)},a.isArray=function(e){return Array.isArray?Array.isArray(e):e instanceof Array},a.isEmptyObject=function(e){return"{}"===JSON.stringify(e)},a.addEvt=function(e,t,n,i){return a.isElement(e)?(i=i||!1,void(e.addEventListener&&e.addEventListener(t,n,i))):void console.warn("$api.addEvt Function need el param, el param must be DOM Element")},a.rmEvt=function(e,t,n,i){return a.isElement(e)?(i=i||!1,void(e.removeEventListener&&e.removeEventListener(t,n,i))):void console.warn("$api.rmEvt Function need el param, el param must be DOM Element")},a.one=function(e,t,n,i){if(!a.isElement(e))return void console.warn("$api.one Function need el param, el param must be DOM Element");i=i||!1;var r=this,o=function(){n&&n(),r.rmEvt(e,t,o,i)};r.addEvt(e,t,o,i)},a.dom=function(e,t){if(1===arguments.length&&"string"==typeof arguments[0]){if(document.querySelector)return document.querySelector(arguments[0])}else if(2===arguments.length&&e.querySelector)return e.querySelector(t)},a.domAll=function(e,t){if(1===arguments.length&&"string"==typeof arguments[0]){if(document.querySelectorAll)return document.querySelectorAll(arguments[0])}else if(2===arguments.length&&e.querySelectorAll)return e.querySelectorAll(t)},a.byId=function(e){return document.getElementById(e)},a.first=function(e,t){return 1===arguments.length?a.isElement(e)?e.children[0]:void console.warn("$api.first Function need el param, el param must be DOM Element"):2===arguments.length?this.dom(e,t+":first-child"):void 0},a.last=function(e,t){if(1===arguments.length){if(!a.isElement(e))return void console.warn("$api.last Function need el param, el param must be DOM Element");var n=e.children;return n[n.length-1]}if(2===arguments.length)return this.dom(e,t+":last-child")},a.eq=function(e,t){return this.dom(e,":nth-child("+t+")")},a.not=function(e,t){return this.domAll(e,":not("+t+")")},a.prev=function(e){if(!a.isElement(e))return void console.warn("$api.prev Function need el param, el param must be DOM Element");var t=e.previousSibling;return t.nodeType&&3===t.nodeType?t=t.previousSibling:void 0},a.next=function(e){if(!a.isElement(e))return void console.warn("$api.next Function need el param, el param must be DOM Element");var t=e.nextSibling;return t.nodeType&&3===t.nodeType?t=t.nextSibling:void 0},a.closest=function(e,t){if(!a.isElement(e))return void console.warn("$api.closest Function need el param, el param must be DOM Element");var n,i,r=function(e,t){var a=0,n=e.length;for(a;a<n;a++)if(e[a].isEqualNode(t))return e[a];return!1},o=function(e,t){for(n=a.domAll(e.parentNode,t),i=r(n,e);!i;){if(e=e.parentNode,null!=e&&e.nodeType==e.DOCUMENT_NODE)return!1;o(e,t)}return i};return o(e,t)},a.contains=function(e,t){var a=!1;if(t===e)return a=!0;do if(t=t.parentNode,t===e)return a=!0;while(t===document.body||t===document.documentElement);return a},a.remove=function(e){e&&e.parentNode&&e.parentNode.removeChild(e)},a.attr=function(e,t,n){return a.isElement(e)?2==arguments.length?e.getAttribute(t):3==arguments.length?(e.setAttribute(t,n),e):void 0:void console.warn("$api.attr Function need el param, el param must be DOM Element")},a.removeAttr=function(e,t){return a.isElement(e)?void(2===arguments.length&&e.removeAttribute(t)):void console.warn("$api.removeAttr Function need el param, el param must be DOM Element")},a.hasCls=function(e,t){return a.isElement(e)?e.className.indexOf(t)>-1:void console.warn("$api.hasCls Function need el param, el param must be DOM Element")},a.addCls=function(e,t){if(!a.isElement(e))return void console.warn("$api.addCls Function need el param, el param must be DOM Element");if("classList"in e)e.classList.add(t);else{var n=e.className,i=n+" "+t;e.className=i}return e},a.removeCls=function(e,t){if(!a.isElement(e))return void console.warn("$api.removeCls Function need el param, el param must be DOM Element");if("classList"in e)e.classList.remove(t);else{var n=e.className,i=n.replace(t,"");e.className=i}return e},a.toggleCls=function(e,t){return a.isElement(e)?("classList"in e?e.classList.toggle(t):a.hasCls(e,t)?a.addCls(e,t):a.removeCls(e,t),e):void console.warn("$api.toggleCls Function need el param, el param must be DOM Element")},a.val=function(e,t){if(!a.isElement(e))return void console.warn("$api.val Function need el param, el param must be DOM Element");if(1===arguments.length)switch(e.tagName){case"SELECT":var n=e.options[e.selectedIndex].value;return n;case"INPUT":return e.value;case"TEXTAREA":return e.value}if(2===arguments.length)switch(e.tagName){case"SELECT":return e.options[e.selectedIndex].value=t,e;case"INPUT":return e.value=t,e;case"TEXTAREA":return e.value=t,e}},a.prepend=function(e,t){return a.isElement(e)?(e.insertAdjacentHTML("afterbegin",t),e):void console.warn("$api.prepend Function need el param, el param must be DOM Element")},a.append=function(e,t){return a.isElement(e)?(e.insertAdjacentHTML("beforeend",t),e):void console.warn("$api.append Function need el param, el param must be DOM Element")},a.before=function(e,t){return a.isElement(e)?(e.insertAdjacentHTML("beforebegin",t),e):void console.warn("$api.before Function need el param, el param must be DOM Element")},a.after=function(e,t){return a.isElement(e)?(e.insertAdjacentHTML("afterend",t),e):void console.warn("$api.after Function need el param, el param must be DOM Element")},a.html=function(e,t){return a.isElement(e)?1===arguments.length?e.innerHTML:2===arguments.length?(e.innerHTML=t,e):void 0:void console.warn("$api.html Function need el param, el param must be DOM Element")},a.text=function(e,t){return a.isElement(e)?1===arguments.length?e.textContent:2===arguments.length?(e.textContent=t,e):void 0:void console.warn("$api.text Function need el param, el param must be DOM Element")},a.offset=function(e){if(!a.isElement(e))return void console.warn("$api.offset Function need el param, el param must be DOM Element");var t=Math.max(document.documentElement.scrollLeft,document.body.scrollLeft),n=Math.max(document.documentElement.scrollTop,document.body.scrollTop),i=e.getBoundingClientRect();return{l:i.left+t,t:i.top+n,w:e.offsetWidth,h:e.offsetHeight}},a.css=function(e,t){return a.isElement(e)?void("string"==typeof t&&t.indexOf(":")>0&&e.style&&(e.style.cssText+=";"+t)):void console.warn("$api.css Function need el param, el param must be DOM Element")},a.cssVal=function(t,n){if(!a.isElement(t))return void console.warn("$api.cssVal Function need el param, el param must be DOM Element");if(2===arguments.length){var i=e.getComputedStyle(t,null);return i.getPropertyValue(n)}},a.jsonToStr=function(e){if("object"==typeof e)return JSON&&JSON.stringify(e)},a.strToJson=function(e){if("string"==typeof e)return JSON&&JSON.parse(e)},a.setStorage=function(e,t){if(2===arguments.length){var a=t;"object"==typeof a?(a=JSON.stringify(a),a="obj-"+a):a="str-"+a;var n=i();n&&n.setItem(e,a)}},a.getStorage=function(e){var t=i();if(t){var a=t.getItem(e);if(!a)return;if(0===a.indexOf("obj-"))return a=a.slice(4),JSON.parse(a);if(0===a.indexOf("str-"))return a.slice(4)}},a.rmStorage=function(e){var t=i();t&&e&&t.removeItem(e)},a.clearStorage=function(){var e=i();e&&e.clear()},a.fixIos7Bar=function(e){if(!a.isElement(e))return void console.warn("$api.fixIos7Bar Function need el param, el param must be DOM Element");var t=api.systemType;if("ios"==t){var n=api.systemVersion,i=parseInt(n,10),r=api.fullScreen,o=api.iOS7StatusBarAppearance;i>=7&&!r&&o&&(e.style.paddingTop="20px")}},a.fixStatusBar=function(e){if(!a.isElement(e))return void console.warn("$api.fixStatusBar Function need el param, el param must be DOM Element");var t=api.systemType;if("ios"==t)a.fixIos7Bar(e);else if("android"==t){var n=api.systemVersion;n=parseFloat(n),n>=4.4&&(e.style.paddingTop="25px")}},a.toast=function(e,t,a){var n={},i=function(e,t){api.showProgress(e),setTimeout(function(){api.hideProgress()},t)};if(1===arguments.length){var a=a||500;"number"==typeof e?a=e:n.title=e+"",i(n,a)}else if(2===arguments.length){var a=a||500,t=t;if("number"==typeof t){var r=t;a=r,t=null}e&&(n.title=e),t&&(n.text=t),i(n,a)}e&&(n.title=e),t&&(n.text=t),a=a||500,i(n,a)},a.post=function(){var e=t.apply(null,arguments),a={},n=e.fnSuc;if(e.url&&(a.url=e.url),e.data&&(a.data=e.data),e.dataType){var i=e.dataType.toLowerCase();"text"!=i&&"json"!=i||(a.dataType=i)}else a.dataType="json";a.method="post",api.ajax(a,function(e,t){e&&n&&n(e)})},a.get=function(){var e=t.apply(null,arguments),a={},n=e.fnSuc;if(e.url&&(a.url=e.url),e.dataType){var i=e.dataType.toLowerCase();"text"!=i&&"json"!=i||(a.dataType=i)}else a.dataType="text";a.method="get",api.ajax(a,function(e,t){e&&n&&n(e)})},a.setcookie=function(e,t,a){var n=new Date;n.setDate(n.getDate()+a),document.cookie=e+"="+encodeURI(t)+(null==a?"":";expires="+n.toGMTString())},a.getcookie=function(e){for(var t=document.cookie.split("; "),a=0;a<t.length;a++){var n=t[a].split("=");if(n[0]==e)return decodeURI(n[1])}return null},a.removecookie=function(e){a.setcookie(e,"",-1)},e.$util=a}(window),myDirective.directive("addList",function(){return{restrict:"E",scope:{inputName:"=",inputShow:"=",inputSelect:"=",inputTitle:"@",inputTpl:"@",inputFmt:"@",inputChange:"=",inputClear:"="},templateUrl:"html/directive/addlist/DirectiveAddList.html",controller:["$scope","$element","ngDialog","myServiceUtil","api",function(e,t,a,n,i){e.checkbox_value={},e.check_code_arr=[],e.check_name_arr=[],e.check_name_obj=[],e.set_value=function(){if(console.log(e.check_name_obj),a.close(r),"function"==typeof e.inputChange){var t=e.check_name_obj;e.inputChange(t)}e.checkbox_value={},e.check_code_arr=[],e.check_name_arr=[],e.check_name_obj=[]},e.update_check=function(t){if(console.log(t),1==e.checkbox_value[t.code]){var a={};a.form_code=t.code,a.form_name=t.name,a.form_id=t.id,e.check_code_arr.push(t.code),e.check_name_arr.push(t.name),e.check_name_obj.push(a)}else-1!=e.check_code_arr.indexOf(t.code)&&e.check_code_arr.splice(e.check_code_arr.indexOf(t.code),1),-1!=e.check_name_arr.indexOf(t.name)&&e.check_name_arr.splice(e.check_name_arr.indexOf(t.name),1)},e.clear_input_data=function(){e.inputValue=[],e.inputName="",e.check_code_arr=[],e.check_name_arr=[],e.checkbox_value={},"function"==typeof e.inputClear&&e.inputClear()},e.check_all=function(){e.list_data.forEach(function(t){e.checkbox_value[t.code]=!0,-1==e.check_code_arr.indexOf(t.code)&&e.check_code_arr.push(t.code),-1==e.check_name_arr.indexOf(t.name)&&e.check_name_arr.push(t.name)})},e.check_cancel_all=function(){e.list_data.forEach(function(t){e.checkbox_value={},e.check_code_arr=[],e.check_name_arr=[]})},e.search_data={},e.page_data={},e.list_data=[],e.form_search=function(){e.inputSelect({search_data:e.search_data,page_data:e.page_data}).then(function(t){e.list_data=t.data,e.page_data=t.page_data})};var r=0;e.open_select_window=function(){e.form_search(),r=a.open({overlay:!0,disableAnimation:!0,showClose:!0,width:500,template:"html/directive/addlist/DirectiveAddListWindow.html",scope:e})}}]}}),myDirective.directive("addTemplate",function(){return{restrict:"E",scope:{inputTitle:"@",inputFunc:"=",inputText:"@",inputTpl:"@",inputFilter:"="},template:'<button class="button" title="{{inputTitle}}" ng-click="open_select_window()">{{inputText}}</button>',controller:["$rootScope","$scope","$element","ngDialog",function(e,t,a,n){t.from_data={},t.search_data_option=e.search_data_option,t.form_save=function(){if("object"==typeof t.inputFilter)for(k in t.inputFilter)t.from_data[k]=t.inputFilter[k];t.inputFunc(t.from_data),t.from_data={},n.close(i)};var i=0,r="html/directive/addtemplate/Directive"+t.inputTpl+"Window.html";t.open_select_window=function(){i=n.open({overlay:!0,disableAnimation:!0,showClose:!0,width:"",template:r,scope:t})}}]}}),myDirective.directive("apiList",function(){return{restrict:"E",scope:{listTitle:"@",listValue:"=",listDefaultShow:"=",itemClick:"="},templateUrl:"html/directive/apilist/DirectiveApidetaillist.html",controller:["$scope","$element",function(e,t){e.click=function(t){"function"==typeof e.itemClick&&e.itemClick(t)}}]}}),myDirective.directive("categoryList",function(){return{restrict:"E",scope:{listTitle:"@",listValue:"=",listDefaultShow:"=",itemClick:"="},templateUrl:"html/directive/categorylist/DirectiveCategorylist.html",controller:["$scope","$element",function(e,t){e.click=function(t){"function"==typeof e.itemClick&&e.itemClick(t)}}]}}),myDirective.directive("categorygoodsList",function(){return{restrict:"E",scope:{listTitle:"@",listValue:"=",listDefaultShow:"=",itemClick:"="},templateUrl:"html/directive/categorylist/DirectiveCategorygoodslist.html",controller:["$scope","$element",function(e,t){e.click=function(t){"function"==typeof e.itemClick&&e.itemClick(t)}}]}}),myDirective.directive("excelImport",["$parse","ngDialog",function(e,t){var a={vip:{code:"vip",title:"会员",tpl:"index.php?app_act=common/excel_template/get_template_by_code&code=vip"},customer:{code:"customer",title:"顾客",tpl:"index.php?app_act=common/excel_template/get_template_by_code&code=customer"},area:{code:"area",title:"顾客",tpl:"index.php?app_act=common/excel_template/get_template_by_code&code=area"},brand:{code:"brand",title:"顾客",tpl:"index.php?app_act=common/excel_template/get_template_by_code&code=brand"},shop:{code:"shop",title:"顾客",tpl:"index.php?app_act=common/excel_template/get_template_by_code&code=shop"}},n="common/excel_import/import";return{restrict:"A",link:function(i,r,o){if(e(o.excelImport)(i)){var c=e(o.excelCode)(i);i.data.excel_data=a[c],r.on("click",function(){i.excelImportOpen()});var l=0;i.excelImportOpen=function(){l=t.open({overlay:!0,disableAnimation:!0,showClose:!0,width:"350px",template:"html/directive/excel/ExcelImportWindow.html",scope:i,controller:["$scope","api",function(e,a){e.import_excel=function(){a.request(n,{path:e.data.excel_data.value,code:e.data.excel_data.code}).then(function(a){1==a.status?(t.close(l),e.data.excel_data.value="",e.data.excel_data.name="",e.alert("导入成功")):e.alert(a.message)})}}]})}}}}}]).directive("excelExport",["$parse","ngDialog","api",function(e,t,a){var n="common/excel_export/export";return{restrict:"A",link:function(t,i,r){if(e(r.excelExport)(t)){var o=e(r.excelCode)(t),c=t.data.search_data;i.on("click",function(){t.excelExportDownload()}),t.excelExportDownload=function(){t.notice("下载已经启动，请注意不要反复点击重复提交请求"),a.request(n,{code:o,search_data:c},{responseType:"arraybuffer"}).then(function(e){var t=new Blob([e],{type:"application/vnd.ms-excel"}),a=URL.createObjectURL(t),n=$("<a><span class='forExcel'>下载excel</span></a>").attr("href",a);$("body").append(n),$(".forExcel").click(),n.remove()})}}}}}]),myDirective.directive("pager",function(){return{restrict:"E",scope:{pageData:"=",pageFunc:"="},templateUrl:"html/directive/pager/PagerList.html",controller:["$scope","$element","$route","ngDialog",function(e,t,a,n){var i="default";try{i=a.current.$$route.originalPath}catch(e){}var r=$util.getStorage("pager_conf_local")?$util.getStorage("pager_conf_local"):{};void 0!=r[i]?e.pageData.num=parseInt(r[i]):e.pageData.num=15,e.goto_prev=function(){e.pageData.pageNum>1&&e.pageData.pageNum--,e.goto_page(e.pageData.pageNum)},e.goto_next=function(){e.pageData.pageNum<e.pageData.countPage&&e.pageData.pageNum++,e.goto_page(e.pageData.pageNum)},e.goto_first=function(){e.goto_page(1)},e.goto_last=function(){e.goto_page(e.pageData.countPage)},e.goto_page=function(t){e.pageData.num=parseInt(e.pageData.num),e.pageData.pageNum=t,e.pageFunc()},e.change_page_size=function(){r[i]=e.pageData.num,$util.setStorage("pager_conf_local",r),e.goto_page(1)}}]}}),myDirective.directive("selectArea",function(){return{restrict:"E",scope:{inputValue:"=",inputReadonly:"="},templateUrl:"html/directive/selectarea/DirectiveSelectArea.html",controller:["$scope","$element","api",function(e,t,a){a.request("base/region/get_all_tree").then(function(t){e.area_data=t.data[0].child,"undefined"!=typeof e.inputValue&&e.area_data.forEach(function(t){"undefined"!=typeof e.inputValue.province&&t.region_id==e.inputValue.province&&(e.select1=t,e.select1.child.forEach(function(t){"undefined"!=typeof e.inputValue.city&&t.region_id==e.inputValue.city&&(e.select2=t,e.select2.child.forEach(function(t){"undefined"!=typeof e.inputValue.district&&t.region_id==e.inputValue.district&&(e.select3=t)}))}))})}),e.change1=function(){e.inputValue.province=e.select1.region_id},e.change2=function(){e.inputValue.city=null==e.select2?"":e.select2.region_id},e.change3=function(){e.inputValue.district=null==e.select3?"":e.select3.region_id}}]}}),myDirective.directive("selectDate",function(){return{restrict:"E",scope:{inputValue:"=",inputTitle:"@",inputReadonly:"=",inputFormat:"@"},templateUrl:"html/directive/selectdate/DirectiveSelectDate.html",controller:["$scope","$element","ngDialog",function(e,t,a){e.alertOnEventClick=function(t,i,r){e.inputValue=t.format(),a.close(n)},e.eventSources=[],e.uiConfig={calendar:{height:520,editable:!0,header:{left:"title",center:"",right:"today prevYear,prev,next,nextYear"},dayClick:e.alertOnEventClick,dayNames:["周日","周一","周二","周三","周四","周五","周六"],dayNamesShort:["日","一","二","三","四","五","六"],monthNames:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],monthNamesShort:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],buttonText:{today:"今日",month:"月",week:"周",day:"日"},nowIndicator:!0,eventBackgroundColor:"#378006"}};var n=0;e.open_select_window=function(){e.inputReadonly||(void 0!=e.inputValue&&""!=e.inputValue&&"0000-00-00 00:00:00"!=e.inputValue&&"0000-00-00"!=e.inputValue&&(e.uiConfig.calendar.defaultDate=e.inputValue,e.uiConfig.calendar.events=[{title:"已选",start:e.inputValue,allDay:!0}]),n=a.open({overlay:!0,disableAnimation:"",showClose:!0,width:500,height:"",template:"html/directive/selectdate/DirectiveSelectDateWindow.html",scope:e}))}}]}}),myDirective.directive("selectMulti",function(){return{restrict:"E",scope:{inputValue:"=",inputName:"=",inputSelect:"=",inputTitle:"@",inputPlaceholder:"@",inputReadonly:"=",inputTpl:"@",inputFmt:"@",inputChange:"=",inputClear:"="},templateUrl:"html/directive/selectmulti/DirectiveSelectMulti.html",controller:["$scope","$element","ngDialog","myServiceUtil","api",function(e,t,a,n,i){e.checkbox_value={},e.check_code_arr=[],e.check_name_arr=[],e.set_value=function(){if(e.inputValue=e.check_code_arr,e.inputFmt||(e.inputValue="",e.check_code_arr.forEach(function(t,a){e.inputValue=e.inputValue+t,a!==e.check_code_arr.length-1&&(e.inputValue=e.inputValue+",")})),e.inputName="",""!=e.check_name_arr[0]&&null!=e.check_name_arr[0]&&(e.inputName=e.inputName+e.check_name_arr[0]),""!=e.check_name_arr[1]&&null!=e.check_name_arr[1]&&(e.inputName=e.inputName+","+e.check_name_arr[1]),""!=e.check_name_arr[2]&&null!=e.check_name_arr[2]&&(e.inputName=e.inputName+","+e.check_name_arr[2]),""!=e.check_name_arr[3]&&null!=e.check_name_arr[3]&&(e.inputName=e.inputName+"..."),a.close(r),"function"==typeof e.inputChange){var t=e.inputValue;e.inputChange(t)}},e.update_check=function(t){1==e.checkbox_value[t.code]?(e.check_code_arr.push(t.code),e.check_name_arr.push(t.name)):(-1!=e.check_code_arr.indexOf(t.code)&&e.check_code_arr.splice(e.check_code_arr.indexOf(t.code),1),-1!=e.check_name_arr.indexOf(t.name)&&e.check_name_arr.splice(e.check_name_arr.indexOf(t.name),1))},e.clear_input_data=function(){e.inputValue=[],e.inputName="",e.check_code_arr=[],e.check_name_arr=[],e.checkbox_value={},"function"==typeof e.inputClear&&e.inputClear()},e.check_all=function(){e.list_data.forEach(function(t){e.checkbox_value[t.code]=!0,-1==e.check_code_arr.indexOf(t.code)&&e.check_code_arr.push(t.code),-1==e.check_name_arr.indexOf(t.name)&&e.check_name_arr.push(t.name)})},e.check_cancel_all=function(){e.list_data.forEach(function(t){e.checkbox_value={},e.check_code_arr=[],e.check_name_arr=[]})},e.search_data={},e.page_data={},e.list_data=[],e.form_search=function(){e.inputSelect({search_data:e.search_data,page_data:e.page_data}).then(function(t){e.list_data=t.data,e.page_data=t.page_data})};var r=0;e.open_select_window=function(){if(!e.inputReadonly){e.checkbox_value={},"undefined"==typeof e.inputValue&&(e.inputValue=e.inputFmt?[]:""),e.inputFmt||"string"!=typeof e.inputValue||(e.inputValue=e.inputValue.split(",")),e.inputValue.forEach(function(t){e.checkbox_value[t]=!0});var t="html/directive/selectmulti/DirectiveSelectMultiWindow.html",o=n.strtoUp2(e.inputTpl);switch(o){case"SelectOrg":t="html/directive/selectmulti/DirectiveSelectMultiWindow"+o+".html",e.mutile={},e.mutile.category_data_show=!0,e.mutile.category_data=[],e.mutile.category_click=function(t){e.search_data.p_code=t.code,e.page_data.num=1,e.form_search()},i.request("base/org/get_tree_data_by_code",{deep_num:3}).then(function(t){e.mutile.category_data=t.data})}e.form_search(),r=a.open({overlay:!0,disableAnimation:!0,showClose:!0,width:"",template:t,scope:e})}}}]}}),myDirective.directive("selectMultiBtn",function(){return{restrict:"E",scope:{inputSelect:"=",inputTitle:"@",inputReadonly:"=",inputFunc:"="},template:'<button class="button" title="{{inputTitle}}" ng-click="open_select_window()"><span class="glyphicon glyphicon-plus" ng-class="btn.ico">{{inputTitle}}</span></button>',controller:["$scope","$element","ngDialog",function(e,t,a){e.checkbox_value={},e.check_code_arr=[],e.check_name_arr=[],e.set_value=function(){e.inputFunc(e.check_code_arr),a.close(n)},e.update_check=function(t){1==e.checkbox_value[t.code]?(e.check_code_arr.push(t.code),e.check_name_arr.push(t.name)):(-1!=e.check_code_arr.indexOf(t.code)&&e.check_code_arr.splice(e.check_code_arr.indexOf(t.code),1),
-1!=e.check_name_arr.indexOf(t.name)&&e.check_name_arr.splice(e.check_name_arr.indexOf(t.name),1))},e.clear_input_data=function(){e.inputValue=[],e.inputName="",e.check_code_arr=[],e.check_name_arr=[],e.checkbox_value={}},e.check_all=function(){e.list_data.forEach(function(t){e.checkbox_value[t.code]=!0,-1==e.check_code_arr.indexOf(t.code)&&e.check_code_arr.push(t.code),-1==e.check_name_arr.indexOf(t.name)&&e.check_name_arr.push(t.name)})},e.check_cancel_all=function(){e.list_data.forEach(function(t){e.checkbox_value={},e.check_code_arr=[],e.check_name_arr=[]})},e.search_data={},e.page_data={},e.list_data=[],e.form_search=function(){e.inputSelect({search_data:e.search_data,page_data:e.page_data}).then(function(t){e.list_data=t.data,e.page_data=t.page_data})};var n=0;e.open_select_window=function(){e.inputReadonly||(e.form_search(),n=a.open({overlay:!0,disableAnimation:!0,showClose:!0,width:"",template:"html/directive/selectmulti/DirectiveSelectMultiWindow.html",scope:e}))}}]}}),myDirective.directive("selectSimple",function(){return{restrict:"E",scope:{inputValue:"=",inputName:"=",inputSelect:"=",inputReadonly:"=",inputFilter:"=",inputSelectData:"=",inputChange:"="},templateUrl:"html/directive/selectsimple/DirectiveSelectSimple.html",controller:["$scope","$element","ngDialog",function(e,t,a){e.select_data={},e.form_search=function(){if(void 0!=e.inputSelect)e.inputSelect({search_data:e.search_data,page_data:e.page_data}).then(function(t){e.select_data=t.data,"undefined"!=typeof e.inputValue&&e.select_data.forEach(function(t){"undefined"!=typeof e.inputValue&&t.code==e.inputValue&&(e.select=t)})});else for(i in e.inputSelectData)e.inputSelectData[i].name=e.inputSelectData[i].level_name,e.select_data[i]=e.inputSelectData[i],console.log(e.select_data[i])},e.form_search(),e.change=function(){e.inputValue=e.select.code,e.inputName=e.select.name,void 0!=e.inputChange&&e.inputChange(e.inputValue),console.log(e.select),e.select="",console.log(e.inputValue),console.log(e.inputName)}}]}}),myDirective.directive("selectSingle",function(){return{restrict:"E",scope:{inputValue:"=",inputName:"=",inputSelect:"=",inputTitle:"@",inputPlaceholder:"@",inputReadonly:"=",inputFilter:"=",inputChange:"=",inputWidth:"@",inputClear:"="},templateUrl:"html/directive/selectsingle/DirectiveSelectSingle.html",controller:["$scope","$element","ngDialog",function(e,t,a){var n=e.inputWidth?e.inputWidth:"50%";e.set_value=function(t){e.inputValue=t.code,e.inputName=t.name,a.close(r.id),"function"==typeof e.inputChange&&e.inputChange(t)},e.clear_input_data=function(){e.inputValue="",e.inputName="","function"==typeof e.inputClear&&e.inputClear()},e.search_data={},e.page_data={},e.list_data=[],e.form_search=function(){var t={search_data:e.search_data,page_data:e.page_data};if(e.inputFilter)for(i in e.inputFilter)t.search_data[i]=e.inputFilter[i];e.inputSelect(t).then(function(t){e.list_data=t.data,e.page_data=t.page_data})};var r=0;e.open_select_window=function(){e.inputReadonly||(e.form_search(),r=a.open({overlay:!0,disableAnimation:!0,showClose:!0,width:n,template:"html/directive/selectsingle/DirectiveSelectSingleWindow.html",scope:e}))}}]}}),myDirective.directive("selectSingleBtn",function(){return{restrict:"E",scope:{inputSelect:"=",inputTitle:"@",inputReadonly:"=",inputFunc:"="},template:'<button ng-click="open_select_window();">{{inputTitle}}</button>',controller:["$scope","$element","ngDialog",function(e,t,a){e.set_value=function(t){e.inputFunc(t),a.close(n)},e.search_data={},e.page_data={},e.list_data=[],e.form_search=function(){e.inputSelect({search_data:e.search_data,page_data:e.page_data}).then(function(t){e.list_data=t.data,e.page_data=t.page_data})};var n=0;e.open_select_window=function(){e.inputReadonly||(e.form_search(),n=a.open({overlay:!0,disableAnimation:!0,showClose:!0,width:"",template:"html/directive/selectsingle/DirectiveSelectSingleWindow.html",scope:e}))}}]}}),myDirective.directive("tableSimple",function(){return{restrict:"E",scope:{tableHead:"=",tableBody:"="},templateUrl:"html/directive/tableSimple/DirectiveTableSimple.html",controller:["$scope","$element","ngDialog",function(e,t,a){console.log(e.tableBody)}]}}),myDirective.directive("uploadExcel",function(){return{restrict:"E",scope:{inputValue:"=",inputName:"=",inputReadonly:"=",inputChange:"=",inputPath:"@"},templateUrl:"html/directive/uploadexcel/DirectiveUploadExcel.html",controller:["$scope","$element","ngDialog","api","Upload","Popup",function(e,t,a,n,i,r){e.switch=!1;e.inputValue,e.inputName;"undefined"!=typeof e.inputPath&&""!=e.inputPath||(e.inputPath="base"),e.file_select=function(t){e.inputReadonly||void 0!=t&&(e.switch=!0,e.inputTempfile=t,e.inputName=t.name)},e.upload_file=function(){if(!e.inputReadonly){var t=n.get_api_url("common/fileupload/excel");i.upload({url:t,data:{file:e.inputTempfile,sid:"sid",path:e.inputPath}}).then(function(t){e.switch=!1,1==t.data.status?(r.notice("上传成功"),e.inputValue=t.data.data.url,e.inputName=t.data.data.name):(e.inputValue="",e.inputName="",alert(t.data.message))},function(t){e.switch=!1,alert("上传失败!"+t.status)},function(t){var a=parseInt(100*t.loaded/t.total);e.inputName=a+"%"})}},e.clear_input_data=function(){e.switch=!1,e.inputValue="",e.inputName=""}}]}}),myDirective.directive("uploadPicture",function(){return{restrict:"E",scope:{inputValue:"=",inputName:"=",inputReadonly:"=",inputChange:"=",inputPath:"@"},templateUrl:"html/directive/uploadpicture/DirectiveUploadPicture.html",controller:["$scope","$element","ngDialog","api","Upload",function(e,t,a,n,i){e.switch=!1;var r=e.inputValue,o=e.inputName;"undefined"!=typeof e.inputPath&&""!=e.inputPath||(e.inputPath="base"),e.file_select=function(t){e.inputReadonly||void 0!=t&&(e.switch=!0,e.inputTempfile=t,e.inputName=t.name)},e.upload_file=function(){if(!e.inputReadonly){var t=n.get_api_url("common/fileupload/picture");i.upload({url:t,data:{file:e.inputTempfile,sid:"sid",path:e.inputPath}}).then(function(t){e.switch=!1,t.data.status?(e.inputValue=t.data.data.url,e.inputName=t.data.data.name,e.preview_pic()):alert(t.data.message)},function(t){e.switch=!1,alert("上传失败!"+t.status)},function(t){var a=parseInt(100*t.loaded/t.total);e.inputName=a+"%"})}};var c=0;e.preview_pic=function(){return e.inputValue&&""!=e.inputValue?void(c=a.open({overlay:!0,disableAnimation:!0,showClose:!0,width:340,template:"html/directive/uploadpicture/DirectiveUploadPicturePreview.html",scope:e})):(alert("暂无图片"),!1)},e.refresh_input_data=function(){e.switch=!1,e.inputValue=r,e.inputName=o},e.clear_input_data=function(){e.switch=!1,e.inputValue="",e.inputName=""}}]}});